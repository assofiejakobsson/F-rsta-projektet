if (self.CavalryLogger) { CavalryLogger.start_js(["4h5IYhI"]); }

__d("MInitJewelCounts",["Arbiter"],(function(a,b,c,d,e,f,g){"use strict";function a(a){c("Arbiter").inform("m:jewels:init-counts",a,"persistent")}g.main=a}),98);
__d("MJewelFlyoutHider",[],(function(a,b,c,d,e,f){"use strict";function a(a){a=document.getElementById(a.id);a&&(a.style.display="none")}f.hide=a}),66);
__d("MJewelNotifications",["Bootloader","ChannelEventType","MRequest","MURI","Run","Stratcom","SubscriptionsHandler","isFacebookURI"],(function(a,b,c,d,e,f,g){"use strict";a=function(){function a(a){var b=this;this.onJewelOpen=function(a){a=a.getData();a=a&&a.jewel&&a.jewel==="notifications";a&&b.$4&&b.updateUI()};this.onNotificationClick=function(a){a=a.getNode("live-notification");if(!a)return;a=a.getAttribute("data-alertid");b.readNotification(a);b.updateUI();new(c("MRequest"))("/a/jewel_notifications_log.php").addData({click_type:"jewel_notif_click",id:a}).send()};this.onNotificationRead=function(a){a=a.getData();a&&a.alert_ids&&(a.alert_ids.forEach(function(a){b.readNotification(a)}),b.updateUI())};this.onNotificationReceive=function(a){a=a.getData();if(a&&a.data){if(a.data.type==="friend_confirmed")return;b.$3||(b.$3=!0,b.registerListeners());b.addNotification(a.data);b.updateUI()}};this.$1=a;this.$2=[];this.$3=!1;this.$4=!1;this.$5=new(c("SubscriptionsHandler"))();this.$5.addSubscriptions(d("Run").onLeave(function(){b.$5.release()}),c("Stratcom").listen(d("ChannelEventType").NOTIFICATIONS_NEW,null,this.onNotificationReceive.bind(this)))}var b=a.prototype;b.getNotifications=function(){return this.$2};b.registerListeners=function(){this.$5.addSubscriptions(c("Stratcom").listen(d("ChannelEventType").NOTIFICATIONS_READ,null,this.onNotificationRead.bind(this)),c("Stratcom").listen("click","live-notifications",this.onNotificationClick.bind(this)),c("Stratcom").listen("m:jewel:flyout:open",null,this.onJewelOpen.bind(this)))};b.readNotification=function(a){var b=this;this.$2.forEach(function(c){c.alert_id==a&&(c.unread&&(b.$4=!0),c.unread=!1)})};b.addNotification=function(a){this.$2=this.$2.filter(function(b){return b.alert_id!==a.alert_id}),a.timestamp=Date.now(),this.$2.push(a),this.$4=!0};b.updateUI=function(){var a=this;if(!this.$3||!this.$4)return;c("Bootloader").loadModules(["React","ReactDOM","MJewelNotificationList.react","Popover"],function(b,c,d,e){if(!e.getInstance("notifications_flyout").isOpen())return;var f={notifications:a.$2};c.render(b.createElement(d,f),a.$1);e.getInstance("notifications_flyout").refreshConstraints();a.$4=!1},"MJewelNotifications")};return a}();g["default"]=a}),98);
__d("MessengerDesktopPromoFalcoEvent",["FalcoLoggerInternal","getFalcoLogPolicy_DO_NOT_USE"],(function(a,b,c,d,e,f){"use strict";a=b("getFalcoLogPolicy_DO_NOT_USE")("1744027");c=b("FalcoLoggerInternal").create("messenger_desktop_promo",a);e.exports=c}),null);
__d("MessengerDesktopPromoUtils",["MessengerDesktopPromoFalcoEvent"],(function(a,b,c,d,e,f,g){"use strict";a=function(a,b,d){a.onclick=function(){c("MessengerDesktopPromoFalcoEvent").log(function(){return{event:"Click",location:b,funnelSessionId:d}})}};b=function(a,b){c("MessengerDesktopPromoFalcoEvent").log(function(){return{event:"Impression",location:a,funnelSessionId:b}})};g.logClick=a;g.logImpression=b}),98);